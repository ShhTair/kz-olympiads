<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">–û–ª–∏–º–ø–∏–∞–¥–∞ | –ë–∞–∑–∞ –û–ª–∏–º–ø–∏–∞–¥–Ω–∏–∫–æ–≤ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <div class="gradient-bg text-white py-8">
        <div class="max-w-6xl mx-auto px-4">
            <a href="/" class="text-sm opacity-75 hover:opacity-100 mb-4 inline-block">‚Üê –ù–∞–∑–∞–¥ –∫ –±–∞–∑–µ</a>
            <div class="flex items-start justify-between">
                <div>
                    <h1 class="text-3xl font-bold mb-2" id="olympiadName">–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
                    <p class="text-lg opacity-90" id="olympiadNameRu"></p>
                </div>
                <div class="text-right">
                    <div class="text-4xl font-bold" id="olympiadCode"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-6xl mx-auto px-4 py-8">
        <!-- Overview -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8" id="overview">
            <!-- Will be populated -->
        </div>

        <!-- Stats -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8" id="statsGrid">
            <!-- Will be populated -->
        </div>

        <!-- All Participants -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-bold mb-6">üë• –í—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –∏–∑ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞</h2>
            <div id="allParticipants" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Will be populated -->
            </div>
        </div>

        <!-- Best Years -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-8" id="bestYearsSection">
            <h2 class="text-2xl font-bold mb-6">üèÜ –õ—É—á—à–∏–µ –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞</h2>
            <div id="bestYears" class="space-y-4">
                <!-- Will be populated -->
            </div>
        </div>

        <!-- External Links -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-bold mb-6">üîó –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã</h2>
            <div id="externalLinks" class="space-y-2">
                <!-- Will be populated -->
            </div>
        </div>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const olympiadId = urlParams.get('id');

        async function loadOlympiad() {
            if (!olympiadId) {
                document.getElementById('olympiadName').textContent = '–û–ª–∏–º–ø–∏–∞–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞';
                return;
            }

            try {
                // Load olympiad info
                const listRes = await fetch('/data/olympiads-list.json');
                const olympiadsList = await listRes.json();
                const olympiadInfo = olympiadsList.find(o => o.id === olympiadId);

                if (!olympiadInfo) {
                    document.getElementById('olympiadName').textContent = '–î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã';
                    return;
                }

                document.getElementById('pageTitle').textContent = `${olympiadInfo.name} | –ë–∞–∑–∞ –û–ª–∏–º–ø–∏–∞–¥–Ω–∏–∫–æ–≤`;
                document.getElementById('olympiadName').textContent = olympiadInfo.name;
                document.getElementById('olympiadNameRu').textContent = olympiadInfo.nameRu;
                document.getElementById('olympiadCode').textContent = olympiadInfo.id.toUpperCase();

                // Overview
                document.getElementById('overview').innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <div class="text-sm text-gray-600 mb-2">–ü—Ä–µ–¥–º–µ—Ç</div>
                            <div class="text-lg font-semibold text-gray-900">${olympiadInfo.subject}</div>
                            <div class="text-sm text-gray-600">${olympiadInfo.subjectRu}</div>
                        </div>
                        <div>
                            <div class="text-sm text-gray-600 mb-2">–£—á–∞—Å—Ç–∏–µ –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞</div>
                            <div class="text-lg font-semibold text-gray-900">${olympiadInfo.kazParticipationStart || 'TBD'} - –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è</div>
                            <div class="text-sm text-gray-600">–ù–∞—á–∞–ª–æ –æ–ª–∏–º–ø–∏–∞–¥—ã: ${olympiadInfo.yearStart}</div>
                        </div>
                    </div>
                    <div class="mt-4 flex flex-wrap gap-2">
                        ${olympiadInfo.tags.map(tag => 
                            `<span class="px-3 py-1 bg-purple-100 text-purple-700 text-sm rounded-full">${tag}</span>`
                        ).join('')}
                    </div>
                `;

                // Load detailed data if available
                if (olympiadId === 'imo') {
                    const res = await fetch('/data/imo-kazakhstan.json');
                    const data = await res.json();
                    renderIMOData(data, olympiadInfo);
                } else if (olympiadId === 'ioi') {
                    const res = await fetch('/data/ioi-kazakhstan.json');
                    const data = await res.json();
                    renderIOIData(data, olympiadInfo);
                } else {
                    // Generic rendering for olympiads without detailed data
                    renderGenericData(olympiadInfo);
                }

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('olympiadName').textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
            }
        }

        function renderIMOData(data, olympiadInfo) {
            // Stats
            document.getElementById('statsGrid').innerHTML = `
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="text-sm text-gray-600 mb-1">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                    <div class="text-3xl font-bold text-purple-600">${data.totalParticipants}+</div>
                    <div class="text-xs text-gray-500 mt-1">${data.participationYears}</div>
                </div>
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="text-sm text-gray-600 mb-1">–ó–æ–ª–æ—Ç–æ</div>
                    <div class="text-3xl font-bold text-yellow-500">${data.totalMedals.gold}</div>
                    <div class="text-xs text-gray-500 mt-1">ü•á –õ—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</div>
                </div>
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="text-sm text-gray-600 mb-1">–°–µ—Ä–µ–±—Ä–æ + –ë—Ä–æ–Ω–∑–∞</div>
                    <div class="text-3xl font-bold text-gray-600">${data.totalMedals.silver + data.totalMedals.bronze}</div>
                    <div class="text-xs text-gray-500 mt-1">ü•à ${data.totalMedals.silver} / ü•â ${data.totalMedals.bronze}</div>
                </div>
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="text-sm text-gray-600 mb-1">–õ—É—á—à–∏–π —Ä–∞–Ω–≥</div>
                    <div class="text-3xl font-bold text-green-600">#${data.bestRank}</div>
                    <div class="text-xs text-gray-500 mt-1">${data.bestRankYear} –≥–æ–¥</div>
                </div>
            `;

            // All participants
            document.getElementById('allParticipants').innerHTML = data.notableParticipants.map(p => `
                <a href="/participant.html?olympiad=imo&name=${encodeURIComponent(p.name)}" 
                   class="block border border-gray-200 rounded-lg p-4 hover:border-purple-300 transition-colors">
                    <div class="font-semibold text-gray-900">${p.name}</div>
                    <div class="text-sm text-gray-600">${p.nameRu}</div>
                    <div class="flex flex-wrap gap-1 mt-2">
                        ${p.medals.slice(0, 3).map(m => {
                            const color = m.includes('Gold') ? 'yellow' : m.includes('Silver') ? 'gray' : 'orange';
                            return `<span class="px-2 py-1 bg-${color}-100 text-${color}-700 text-xs rounded">${m}</span>`;
                        }).join('')}
                        ${p.medals.length > 3 ? `<span class="text-xs text-gray-500">+${p.medals.length - 3}</span>` : ''}
                    </div>
                </a>
            `).join('');

            // Best years
            if (data.yearlyResults) {
                const bestYears = [...data.yearlyResults].sort((a, b) => a.rank - b.rank).slice(0, 5);
                document.getElementById('bestYears').innerHTML = bestYears.map(y => `
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="font-semibold text-lg">IMO ${y.year} - ${y.location}</div>
                                <div class="text-sm text-gray-600 mt-1">–†–∞–Ω–≥: #${y.rank} (—Ç–æ–ø ${y.relativeRank})</div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm font-semibold">–ú–µ–¥–∞–ª–∏:</div>
                                <div class="text-sm">ü•á ${y.medals.gold} ü•à ${y.medals.silver} ü•â ${y.medals.bronze}</div>
                            </div>
                        </div>
                        ${y.notes ? `<div class="text-sm text-gray-500 mt-2">${y.notes}</div>` : ''}
                    </div>
                `).join('');
            }

            // External links
            document.getElementById('externalLinks').innerHTML = `
                <a href="${olympiadInfo.officialSite}" target="_blank" class="block text-purple-600 hover:underline">
                    üåê ${olympiadInfo.officialSite}
                </a>
                <a href="${olympiadInfo.kazPageUrl}" target="_blank" class="block text-purple-600 hover:underline">
                    üá∞üáø –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–±–æ—Ä–Ω–æ–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞
                </a>
                <a href="https://www.imo-official.org/year_info.aspx?year=2025" target="_blank" class="block text-purple-600 hover:underline">
                    üìä –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã IMO
                </a>
            `;
        }

        function renderIOIData(data, olympiadInfo) {
            // Similar to IMO but for IOI
            document.getElementById('statsGrid').innerHTML = `
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="text-sm text-gray-600 mb-1">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                    <div class="text-3xl font-bold text-purple-600">${data.totalParticipants}</div>
                    <div class="text-xs text-gray-500 mt-1">${data.participationYears}</div>
                </div>
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="text-sm text-gray-600 mb-1">–ó–æ–ª–æ—Ç–æ</div>
                    <div class="text-3xl font-bold text-yellow-500">${data.totalMedals.gold}</div>
                    <div class="text-xs text-gray-500 mt-1">ü•á –õ—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</div>
                </div>
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="text-sm text-gray-600 mb-1">–°–µ—Ä–µ–±—Ä–æ + –ë—Ä–æ–Ω–∑–∞</div>
                    <div class="text-3xl font-bold text-gray-600">${data.totalMedals.silver + data.totalMedals.bronze}</div>
                    <div class="text-xs text-gray-500 mt-1">ü•à ${data.totalMedals.silver} / ü•â ${data.totalMedals.bronze}</div>
                </div>
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="text-sm text-gray-600 mb-1">–õ—É—á—à–∏–π —Ä–∞–Ω–≥</div>
                    <div class="text-3xl font-bold text-green-600">#${data.bestRank}</div>
                    <div class="text-xs text-gray-500 mt-1">${data.bestRankYear} –≥–æ–¥</div>
                </div>
            `;

            document.getElementById('allParticipants').innerHTML = data.topScorers.map(p => `
                <a href="/participant.html?olympiad=ioi&name=${encodeURIComponent(p.name)}" 
                   class="block border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors">
                    <div class="font-semibold text-gray-900">${p.name}</div>
                    <div class="text-sm text-gray-600">${p.nameRu}</div>
                    <div class="flex flex-wrap gap-1 mt-2">
                        ${p.medals.slice(0, 3).map(m => {
                            const color = m.includes('Gold') ? 'yellow' : m.includes('Silver') ? 'gray' : 'orange';
                            return `<span class="px-2 py-1 bg-${color}-100 text-${color}-700 text-xs rounded">${m}</span>`;
                        }).join('')}
                        ${p.medals.length > 3 ? `<span class="text-xs text-gray-500">+${p.medals.length - 3}</span>` : ''}
                    </div>
                </a>
            `).join('');

            if (data.notableYears) {
                document.getElementById('bestYears').innerHTML = data.notableYears.map(y => `
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex justify-between items-start">
                            <div>
                                <div class="font-semibold text-lg">IOI ${y.year} - ${y.location}</div>
                                <div class="text-sm text-gray-600 mt-1">–†–∞–Ω–≥: #${y.bestRank}</div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm font-semibold">–ú–µ–¥–∞–ª–∏:</div>
                                <div class="text-sm">ü•á ${y.medals.gold} ü•à ${y.medals.silver} ü•â ${y.medals.bronze}</div>
                            </div>
                        </div>
                        ${y.notes ? `<div class="text-sm text-gray-500 mt-2">${y.notes}</div>` : ''}
                    </div>
                `).join('');
            }

            document.getElementById('externalLinks').innerHTML = `
                <a href="${olympiadInfo.officialSite}" target="_blank" class="block text-purple-600 hover:underline">
                    üåê ${olympiadInfo.officialSite}
                </a>
                <a href="${olympiadInfo.kazPageUrl}" target="_blank" class="block text-purple-600 hover:underline">
                    üá∞üáø –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–±–æ—Ä–Ω–æ–π –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞
                </a>
                <a href="https://stats.ioinformatics.org/olympiads/" target="_blank" class="block text-purple-600 hover:underline">
                    üìä –í—Å–µ IOI –ø–æ –≥–æ–¥–∞–º
                </a>
            `;
        }

        function renderGenericData(olympiadInfo) {
            document.getElementById('statsGrid').innerHTML = `
                <div class="bg-white rounded-lg shadow p-4 col-span-full text-center">
                    <div class="text-gray-600 mb-2">–î–µ—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è</div>
                    <div class="text-sm text-gray-500">–ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞, –ø–æ–ª–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</div>
                </div>
            `;

            document.getElementById('allParticipants').innerHTML = `
                <div class="col-span-full text-center text-gray-500 py-8">
                    –°–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ —Å–±–æ—Ä–∞
                </div>
            `;

            document.getElementById('bestYearsSection').style.display = 'none';

            document.getElementById('externalLinks').innerHTML = `
                ${olympiadInfo.officialSite ? `
                    <a href="${olympiadInfo.officialSite}" target="_blank" class="block text-purple-600 hover:underline">
                        üåê –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç –æ–ª–∏–º–ø–∏–∞–¥—ã
                    </a>
                ` : ''}
                ${olympiadInfo.kazPageUrl ? `
                    <a href="${olympiadInfo.kazPageUrl}" target="_blank" class="block text-purple-600 hover:underline">
                        üá∞üáø –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ö–∞–∑–∞—Ö—Å—Ç–∞–Ω–∞
                    </a>
                ` : ''}
                <div class="mt-4 p-4 bg-blue-50 rounded-lg">
                    <div class="text-sm text-gray-700">
                        ‚ÑπÔ∏è –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ —ç—Ç–æ–π –æ–ª–∏–º–ø–∏–∞–¥–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¥–ª—è –∏—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –±–∞–∑—É.
                    </div>
                </div>
            `;
        }

        loadOlympiad();
    </script>
</body>
</html>
